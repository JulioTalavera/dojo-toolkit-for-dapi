<div class="jsdoc-permalink" style="display:none;">/api/1.7/dojox/mvc/StatefulModel</div><h1 class="jsdoc-title constructorIcon36">dojox.mvc.StatefulModel <span style="font-size:11px;color:#999;">(version 1.7)</span></h1><div class="jsdoc-prototype">Object &raquo; <a class="jsdoc-link" href="/api/1.7/dojo/Stateful">dojo.Stateful</a> &raquo; dojox.mvc.StatefulModel</div><div class="jsdoc-require">dojo.require("dojox.mvc.StatefulModel");</div><div class="jsdoc-prototype">Defined in dojox/mvc/StatefulModel.js</div><div class="jsdoc-function-information"><h3>Usage:</h3><div class="function-signature"><span class="keyword">var</span> foo = new dojox.mvc.StatefulModel(<span class="jsdoc-comment-type">/* Object */</span> args);</div></div><div class="jsdoc-full-summary"><p>A data model is effectively instantiated with a plain JavaScript
object which specifies the initial data structure for the model.</p>

<pre><code>var struct = {
    order   : "abc123",
    shipto  : {
        address : "123 Example St, New York, NY",
        phone   : "212-000-0000"
    },
    items : [
        { part : "x12345", num : 1 },
        { part : "n09876", num : 3 }
    ]
};

var model = dojox.mvc.newStatefulModel({ data : struct });
</code></pre>

<p>The simple example above shows an inline plain JavaScript object
illustrating the data structure to prime the model with, however
the underlying data may be made available by other means, such as
from the results of a dojo.store or dojo.data query.</p>

<p>To deal with stores providing immediate values or Promises, a
factory method for model instantiation is provided. This method
will either return an immediate model or a model Promise depending
on the nature of the store.</p>

<pre><code>var model = dojox.mvc.newStatefulModel({ store: someStore });
</code></pre>

<p>The created data model has the following properties:</p>

<ul>
<li>It enables dijits or custom components in the view to "bind" to
data within the model. A bind creates a bi-directional update
mechanism between the bound view and the underlying data:</li>
<li>The data model is "live" data i.e. it maintains any updates
driven by the view on the underlying data.</li>
<li><p>The data model issues updates to portions of the view if the
data they bind to is updated in the model. For example, if two
dijits are bound to the same part of a data model, updating the
value of one in the view will cause the data model to issue an
update to the other containing the new value.</p></li>
<li><p>The data model internally creates a tree of dojo.Stateful
objects that matches the input, which is effectively a plain
JavaScript object i.e. "pure data". This tree allows dijits or
other view components to bind to any node within the data model.
Typically, dijits with simple values bind to leaf nodes of the
datamodel, whereas containers bind to internal nodes of the
datamodel. For example, a datamodel created using the object below
will generate the dojo.Stateful tree as shown:</p>

<p>var model = dojox.mvc.newStatefulModel({ data : {
    prop1   : "foo",
    prop2   : {
        leaf1   : "bar",
        leaf2   : "baz"
    }
}});</p>

<p>// The created dojo.Stateful tree is illustrated below (all nodes are dojo.Stateful objects)
//
//                  o  (root node)
//                 / \
//   (prop1 node) o   o (prop2 node)
//                   / \
//     (leaf1 node) o   o (leaf2 node)
//
// The root node is accessed using the expression "model" (the var name above). The prop1
// node is accessed using the expression "model.prop1", the leaf2 node is accessed using
// the expression "model.prop2.leaf2" and so on.</p></li>
<li><p>Each of the dojo.Stateful nodes in the model may store data as well
as associated "meta-data", which includes things such as whether
the data is required or readOnly etc. This meta-data differs from
that maintained by, for example, an individual dijit in that this
is maintained by the datamodel and may therefore be affected by
datamodel-level constraints that span multiple dijits or even
additional criteria such as server-side computations.</p></li>
<li><p>When the model is backed by a dojo.store or dojo.data query, the
client-side updates can be persisted once the client is ready to
"submit" the changes (which may include both value changes or
structural changes - adds/deletes). The datamodel allows control
over when the underlying data is persisted i.e. this can be more
incremental or batched per application needs.</p></li>
</ul>

<p>There need not be a one-to-one association between a datamodel and
a view or portion thereof. For example, multiple datamodels may
back the dijits in a view. Indeed, this may be useful where the
binding data comes from a number of data sources or queries, for
example. Just as well, dijits from multiple portions of the view
may be bound to a single datamodel.</p>

<p>Finally, requiring this class also enables all dijits to become data
binding aware. The data binding is commonly specified declaratively
via the "ref" property in the "data-dojo-props" attribute value.</p>

<p>To illustrate, the following is the "Hello World" of such data-bound
widget examples:</p>

<pre><code>&lt;script&gt;
    dojo.require("dojox.mvc");
    dojo.require("dojo.parser");
    var model;
    dojo.addOnLoad(function(){
        model = dojox.mvc.newStatefulModel({ data : {
            hello : "Hello World"
        }});
        dojo.parser.parse();
    }
&lt;/script&gt;

&lt;input id="helloInput" dojoType="dijit.form.TextBox"
    ref="model.hello"&gt;
</code></pre>

<p>or</p>

<pre><code>&lt;script&gt;
    var model;
    require(["dojox/mvc", "dojo/parser"], function(dxmvc, parser){
        model = dojox.mvc.newStatefulModel({ data : {
            hello : "Hello World"
        }});
        parser.parse();
    });
&lt;/script&gt;

&lt;input id="helloInput" data-dojo-type="dijit.form.TextBox"
    data-dojo-props="ref: 'model.hello'"&gt;
</code></pre>

<p>Such data binding awareness for dijits is added by extending the
dijit.<em>WidgetBase class to include data binding capabilities
provided by dojox.mvc.</em>DataBindingMixin, and this class declares a
dependency on dojox.mvc._DataBindingMixin.</p>

<p>The presence of a data model and the data-binding capabilities
outlined above support the flexible development of a number of MVC
patterns on the client. As an example, CRUD operations can be
supported with minimal application code.</p>
</div><div class="jsdoc-children"><div class="jsdoc-field-list"><h2 class="jsdoc-summary-heading">Method Summary <span class="jsdoc-summary-toggle"></span></h2><div class="jsdoc-summary-list"><ul><li class="functionIcon private inherited even"><a class="inline-link" href="#_commit">_commit</a><span class="parameters">()</span> <span>Commits this data model, saves the current state into data to become the saved state,
	so a reset will not undo any prior changes.</span></li><li class="functionIcon private inherited odd"><a class="inline-link" href="#_copyStatefulProperties">_copyStatefulProperties</a><span class="parameters">(src, dest)</span> <span>Copy only the dojo.Stateful properties from src to dest (uses
	duck typing).</span></li><li class="functionIcon private inherited even"><a class="inline-link" href="#_createModel">_createModel</a><span class="parameters">(obj)</span> <span>Create this data model from provided input data.</span></li><li class="functionIcon private inherited odd"><a class="inline-link" href="#_saveToStore">_saveToStore</a><span class="parameters">(store)</span> <span>Commit the current values to the data store:
	- remove() any deleted entries
	- put() any new or updated entries</span></li><li class="functionIcon private inherited even"><a class="inline-link" href="#_watchCallbacks">_watchCallbacks</a><span class="parameters">(name, oldValue, value, ignoreCatchall)</span></li><li class="functionIcon public inherited odd"><a class="inline-link" href="#add">add</a><span class="parameters">(name, stateful)</span> <span>Adds a dojo.Stateful tree represented by the given
	dojox.mvc.StatefulModel at the given property name.</span></li><li class="functionIcon public inherited even"><a class="inline-link" href="#commit">commit</a><span class="parameters">(store)</span> <span>Commits this data model:
	- Saves the current state such that a subsequent reset will not
	undo any prior changes.
	- Persists client-side changes to the data store, if a store
	has been supplied as a parameter or at instantiation.</span></li><li class="functionIcon public  odd"><a class="inline-link" href="#constructor">constructor</a><span class="parameters">(args)</span><span class="jsdoc-returns"> returns dojox.mvc.StatefulModel</span> <span>Instantiates a new data model that view components may bind to.
	This is a private constructor, use the factory method
	instead: dojox.mvc.newStatefulModel(args)</span></li><li class="functionIcon public inherited even"><a class="inline-link" href="#get">get</a><span class="parameters">(name)</span><span class="jsdoc-returns"> returns Any</span> <span>Get a property on a Stateful instance.</span></li><li class="functionIcon public inherited odd"><a class="inline-link" href="#postscript">postscript</a><span class="parameters">(mixin)</span></li><li class="functionIcon public inherited even"><a class="inline-link" href="#remove">remove</a><span class="parameters">(name)</span> <span>Removes the dojo.Stateful tree at the given property name.</span></li><li class="functionIcon public inherited odd"><a class="inline-link" href="#reset">reset</a><span class="parameters">()</span> <span>Resets this data model values to its original state.
	Structural changes to the data model (such as adds or removes)
	are not restored.</span></li><li class="functionIcon public inherited even"><a class="inline-link" href="#set">set</a><span class="parameters">(name, value)</span><span class="jsdoc-returns"> returns dojo.Stateful</span> <span>Set a property on a Stateful instance</span></li><li class="functionIcon public inherited odd"><a class="inline-link" href="#toPlainObject">toPlainObject</a><span class="parameters">()</span> <span>Produces a plain JavaScript object representation of the data
	currently within this data model.</span></li><li class="functionIcon public  even"><a class="inline-link" href="#toString">toString</a><span class="parameters">()</span><span class="jsdoc-returns"> returns String</span> <span>Returns the string representation of the data currently within this data model.</span></li><li class="functionIcon public  odd"><a class="inline-link" href="#valueOf">valueOf</a><span class="parameters">()</span><span class="jsdoc-returns"> returns Object</span> <span>Returns the value representation of the data currently within this data model.</span></li><li class="functionIcon public inherited even"><a class="inline-link" href="#watch">watch</a><span class="parameters">(name, callback)</span> <span>Watches a property for changes</span></li></ul></div></div></div><div class="jsdoc-children"><div class="jsdoc-fields"><h2>Methods</h2><div class="jsdoc-field private inherited even"><div class="jsdoc-title"><a name="_commit"></a><span class="functionIcon">_commit</span></div><div class="jsdoc-inheritance">Defined by <a class="jsdoc-link" href="/api/1.7/dojox/mvc/StatefulModel">dojox.mvc.StatefulModel</a></div><div class="jsdoc-summary">Commits this data model, saves the current state into data to become the saved state,
	so a reset will not undo any prior changes.</div></div><div class="jsdoc-field private inherited odd"><div class="jsdoc-title"><a name="_copyStatefulProperties"></a><span class="functionIcon">_copyStatefulProperties</span></div><div class="jsdoc-inheritance">Defined by <a class="jsdoc-link" href="/api/1.7/dojox/mvc/StatefulModel">dojox.mvc.StatefulModel</a></div><div class="jsdoc-summary">Copy only the dojo.Stateful properties from src to dest (uses
	duck typing).</div><table class="jsdoc-parameters"><tr><th>Parameter</th><th>Type</th><th>Description</th></tr><tr><td class="jsdoc-param-name">src</td><td class="jsdoc-param-type">dojo.Stateful</td><td class="jsdoc-param-description">The source object for the copy.</td></tr><tr><td class="jsdoc-param-name">dest</td><td class="jsdoc-param-type">dojo.Stateful</td><td class="jsdoc-param-description">The target object of the copy.</td></tr></table></div><div class="jsdoc-field private inherited even"><div class="jsdoc-title"><a name="_createModel"></a><span class="functionIcon">_createModel</span></div><div class="jsdoc-inheritance">Defined by <a class="jsdoc-link" href="/api/1.7/dojox/mvc/StatefulModel">dojox.mvc.StatefulModel</a></div><div class="jsdoc-summary">Create this data model from provided input data.</div><table class="jsdoc-parameters"><tr><th>Parameter</th><th>Type</th><th>Description</th></tr><tr><td class="jsdoc-param-name">obj</td><td class="jsdoc-param-type">Object</td><td class="jsdoc-param-description">The input for the model, as a plain JavaScript object.</td></tr></table></div><div class="jsdoc-field private inherited odd"><div class="jsdoc-title"><a name="_saveToStore"></a><span class="functionIcon">_saveToStore</span></div><div class="jsdoc-inheritance">Defined by <a class="jsdoc-link" href="/api/1.7/dojox/mvc/StatefulModel">dojox.mvc.StatefulModel</a></div><div class="jsdoc-summary">Commit the current values to the data store:
	- remove() any deleted entries
	- put() any new or updated entries</div><table class="jsdoc-parameters"><tr><th>Parameter</th><th>Type</th><th>Description</th></tr><tr><td class="jsdoc-param-name">store</td><td class="jsdoc-param-type">"dojo.store.DataStore"</td><td class="jsdoc-param-description">dojo.store.DataStore to use for this commit.</td></tr></table></div><div class="jsdoc-field private inherited even"><div class="jsdoc-title"><a name="_watchCallbacks"></a><span class="functionIcon">_watchCallbacks</span></div><div class="jsdoc-inheritance">Defined by <a class="jsdoc-link" href="/api/1.7/dojo/Stateful">dojo.Stateful</a></div><table class="jsdoc-parameters"><tr><th>Parameter</th><th>Type</th><th>Description</th></tr><tr><td class="jsdoc-param-name">name</td><td class="jsdoc-param-type"></td><td class="jsdoc-param-description"></td></tr><tr><td class="jsdoc-param-name">oldValue</td><td class="jsdoc-param-type"></td><td class="jsdoc-param-description"></td></tr><tr><td class="jsdoc-param-name">value</td><td class="jsdoc-param-type"></td><td class="jsdoc-param-description"></td></tr><tr><td class="jsdoc-param-name">ignoreCatchall</td><td class="jsdoc-param-type"></td><td class="jsdoc-param-description"></td></tr></table></div><div class="jsdoc-field public inherited odd"><div class="jsdoc-title"><a name="add"></a><span class="functionIcon">add</span></div><div class="jsdoc-inheritance">Defined by <a class="jsdoc-link" href="/api/1.7/dojox/mvc/StatefulModel">dojox.mvc.StatefulModel</a></div><div class="jsdoc-summary"><p>In case of arrays, the property names are indices passed
as Strings. An addition of such a dojo.Stateful node
results in right-shifting any trailing sibling nodes.</p>
</div><table class="jsdoc-parameters"><tr><th>Parameter</th><th>Type</th><th>Description</th></tr><tr><td class="jsdoc-param-name">name</td><td class="jsdoc-param-type">String</td><td class="jsdoc-param-description">The property name to use whose value will become the given
	dijit.Stateful tree.</td></tr><tr><td class="jsdoc-param-name">stateful</td><td class="jsdoc-param-type">dojo.Stateful</td><td class="jsdoc-param-description">The dojox.mvc.StatefulModel to insert.</td></tr></table></div><div class="jsdoc-field public inherited even"><div class="jsdoc-title"><a name="commit"></a><span class="functionIcon">commit</span></div><div class="jsdoc-inheritance">Defined by <a class="jsdoc-link" href="/api/1.7/dojox/mvc/StatefulModel">dojox.mvc.StatefulModel</a></div><div class="jsdoc-summary">Commits this data model:
	- Saves the current state such that a subsequent reset will not
	undo any prior changes.
	- Persists client-side changes to the data store, if a store
	has been supplied as a parameter or at instantiation.</div><table class="jsdoc-parameters"><tr><th>Parameter</th><th>Type</th><th>Description</th></tr><tr><td class="jsdoc-param-name">store</td><td class="jsdoc-param-type">"dojo.store.DataStore"</td><td class="jsdoc-param-description"><div><em>Optional.</em></div>dojo.store.DataStore Optional dojo.store.DataStore to use for this commit, if none
	provided but one was provided at instantiation time, that store
	will be used instead.</td></tr></table></div><div class="jsdoc-field public  odd"><div class="jsdoc-title"><a name="constructor"></a><span class="functionIcon">constructor</span></div><div class="jsdoc-inheritance">Overrides <a class="jsdoc-link" href="/api/1.7/Object">Object</a>, <a class="jsdoc-link" href="/api/1.7/dojo/Stateful">dojo.Stateful</a></div><div class="jsdoc-return-type">Returns <strong>dojox.mvc.StatefulModel</strong></div><div class="jsdoc-summary"><p>Creates a tree of dojo.Stateful objects matching the initial
data structure passed as input. The mixin property "data" is
used to provide a plain JavaScript object directly representing
the data structure.</p>
</div><table class="jsdoc-parameters"><tr><th>Parameter</th><th>Type</th><th>Description</th></tr><tr><td class="jsdoc-param-name">args</td><td class="jsdoc-param-type">Object</td><td class="jsdoc-param-description">The mixin properties.</td></tr></table></div><div class="jsdoc-field public inherited even"><div class="jsdoc-title"><a name="get"></a><span class="functionIcon">get</span></div><div class="jsdoc-inheritance">Defined by <a class="jsdoc-link" href="/api/1.7/dojo/Stateful">dojo.Stateful</a></div><div class="jsdoc-return-type">Returns <strong>Any</strong>: <span class="jsdoc-return-description">The property value on this Stateful instance.</span></div><div class="jsdoc-summary"><p>Get a named property on a Stateful object. The property may
potentially be retrieved via a getter method in subclasses. In the base class
this just retrieves the object's property.
For example:
    stateful = new dojo.Stateful({foo: 3});
    stateful.get("foo") // returns 3
    stateful.foo // returns 3</p>
</div><table class="jsdoc-parameters"><tr><th>Parameter</th><th>Type</th><th>Description</th></tr><tr><td class="jsdoc-param-name">name</td><td class="jsdoc-param-type">String</td><td class="jsdoc-param-description">The property to get.</td></tr></table></div><div class="jsdoc-field public inherited odd"><div class="jsdoc-title"><a name="postscript"></a><span class="functionIcon">postscript</span></div><div class="jsdoc-inheritance">Defined by <a class="jsdoc-link" href="/api/1.7/dojo/Stateful">dojo.Stateful</a></div><table class="jsdoc-parameters"><tr><th>Parameter</th><th>Type</th><th>Description</th></tr><tr><td class="jsdoc-param-name">mixin</td><td class="jsdoc-param-type"></td><td class="jsdoc-param-description"></td></tr></table></div><div class="jsdoc-field public inherited even"><div class="jsdoc-title"><a name="remove"></a><span class="functionIcon">remove</span></div><div class="jsdoc-inheritance">Defined by <a class="jsdoc-link" href="/api/1.7/dojox/mvc/StatefulModel">dojox.mvc.StatefulModel</a></div><div class="jsdoc-summary"><p>In case of arrays, the property names are indices passed
as Strings. A removal of such a dojo.Stateful node
results in left-shifting any trailing sibling nodes.</p>
</div><table class="jsdoc-parameters"><tr><th>Parameter</th><th>Type</th><th>Description</th></tr><tr><td class="jsdoc-param-name">name</td><td class="jsdoc-param-type">String</td><td class="jsdoc-param-description">The property name from where the tree will be removed.</td></tr></table></div><div class="jsdoc-field public inherited odd"><div class="jsdoc-title"><a name="reset"></a><span class="functionIcon">reset</span></div><div class="jsdoc-inheritance">Defined by <a class="jsdoc-link" href="/api/1.7/dojox/mvc/StatefulModel">dojox.mvc.StatefulModel</a></div><div class="jsdoc-summary">Resets this data model values to its original state.
	Structural changes to the data model (such as adds or removes)
	are not restored.</div></div><div class="jsdoc-field public inherited even"><div class="jsdoc-title"><a name="set"></a><span class="functionIcon">set</span></div><div class="jsdoc-inheritance">Defined by <a class="jsdoc-link" href="/api/1.7/dojo/Stateful">dojo.Stateful</a></div><div class="jsdoc-return-type">Returns <strong>dojo.Stateful</strong>: <span class="jsdoc-return-description">The function returns this dojo.Stateful instance.</span></div><div class="jsdoc-summary"><p>Sets named properties on a stateful object and notifies any watchers of
the property. A programmatic setter may be defined in subclasses.
For example:
    stateful = new dojo.Stateful();
    stateful.watch(function(name, oldValue, value){
        // this will be called on the set below
    }
    stateful.set(foo, 5);</p>

<p>set() may also be called with a hash of name/value pairs, ex:
    myObj.set({
        foo: "Howdy",
        bar: 3
    })
This is equivalent to calling set(foo, "Howdy") and set(bar, 3)</p>
</div><table class="jsdoc-parameters"><tr><th>Parameter</th><th>Type</th><th>Description</th></tr><tr><td class="jsdoc-param-name">name</td><td class="jsdoc-param-type">String</td><td class="jsdoc-param-description">The property to set.</td></tr><tr><td class="jsdoc-param-name">value</td><td class="jsdoc-param-type">Object</td><td class="jsdoc-param-description">The value to set in the property.</td></tr></table></div><div class="jsdoc-field public inherited odd"><div class="jsdoc-title"><a name="toPlainObject"></a><span class="functionIcon">toPlainObject</span></div><div class="jsdoc-inheritance">Defined by <a class="jsdoc-link" href="/api/1.7/dojox/mvc/StatefulModel">dojox.mvc.StatefulModel</a></div><div class="jsdoc-return-type"><div class="jsdoc-return-description">Object
	The plain JavaScript object representation of the data in this
	model.</div></div><div class="jsdoc-summary">Produces a plain JavaScript object representation of the data
	currently within this data model.</div></div><div class="jsdoc-field public  even"><div class="jsdoc-title"><a name="toString"></a><span class="functionIcon">toString</span></div><div class="jsdoc-inheritance">Overrides <a class="jsdoc-link" href="/api/1.7/Object">Object</a></div><div class="jsdoc-return-type">Returns <strong>String</strong></div><div class="jsdoc-summary">Returns the string representation of the data currently within this data model.</div></div><div class="jsdoc-field public  odd"><div class="jsdoc-title"><a name="valueOf"></a><span class="functionIcon">valueOf</span></div><div class="jsdoc-inheritance">Overrides <a class="jsdoc-link" href="/api/1.7/Object">Object</a></div><div class="jsdoc-return-type">Returns <strong>Object</strong></div><div class="jsdoc-summary">Returns the value representation of the data currently within this data model.</div></div><div class="jsdoc-field public inherited even"><div class="jsdoc-title"><a name="watch"></a><span class="functionIcon">watch</span></div><div class="jsdoc-inheritance">Defined by <a class="jsdoc-link" href="/api/1.7/dojo/Stateful">dojo.Stateful</a></div><div class="jsdoc-return-type"><div class="jsdoc-return-description">An object handle for the watch. The unwatch method of this object
	can be used to discontinue watching this property:
		var watchHandle = obj.watch("foo", callback);
		watchHandle.unwatch(); // callback won't be called now</div></div><div class="jsdoc-summary">Watches a property for changes</div><table class="jsdoc-parameters"><tr><th>Parameter</th><th>Type</th><th>Description</th></tr><tr><td class="jsdoc-param-name">name</td><td class="jsdoc-param-type">String</td><td class="jsdoc-param-description"><div><em>Optional.</em></div>Indicates the property to watch. This is optional (the callback may be the
	only parameter), and if omitted, all the properties will be watched</td></tr><tr><td class="jsdoc-param-name">callback</td><td class="jsdoc-param-type">Function</td><td class="jsdoc-param-description">The function to execute when the property changes. This will be called after
	the property has been changed. The callback will be called with the |this|
	set to the instance, the first argument as the name of the property, the
	second argument as the old value and the third argument as the new value.</td></tr></table></div></div></div>